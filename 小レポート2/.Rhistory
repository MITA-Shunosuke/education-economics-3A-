getwd()
df <- read_csv("第7回別添資料_田中2015（5_1_income_単回帰分析の練習）.csv")
library(tidyverse)
df <- read_csv("tanaka2015.csv")
View(df)
library(tidyverse)
library(ggpubr)
df <- read_csv("tanaka2015.csv")
x1 <- df$修学年数
y1 <- df$`対数_年収（万円）`
x2 <- df$`年収（万円）`
rm(x1)
library(tidyverse)
library(ggpubr)
df <- read_csv("tanaka2015.csv")
x <- df$修学年数
y1 <- df$`対数_年収（万円）`
x2 <- df$`年収（万円）`
fig2 <- fig1 +
geom_smooth(method = "lm", se = FALSE, col = "blue", size = 1)
fig1 <- ggplot(mapping = aes(x = x, y = y)) + geom_point(color = "red", alpha = 0.5) + theme_minimal()
fig2 <- fig1 +
geom_smooth(method = "lm", se = FALSE, col = "blue", size = 1)
View(fig1)
library(magrittr)
rm(fig1, fig2)
y2 <- df$`年収（万円）`
rm(x2)
fit <- lm(y1 ~ x, df)
fit
library(stargazer)
stargazer(fit, type = "text", no.space = TRUE)
rm(x, y1, y2)
sch_year <- df$修学年数
ln_income <- df$`対数_年収（万円）`
income <- df$`年収（万円）`
fit <- lm(ln_income ~ sch_year, df)
stargazer(fit, type = "text", no.space = TRUE)
d_sel %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_jitter(color = "black", alpha = 0.7) +
geom_smooth(method = "lm", color = "blue", se=FALSE) +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_jitter(color = "black", alpha = 0.7) +
geom_smooth(method = "lm", color = "blue", se=FALSE) +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 10.403, slope = 2.957)) +
annotate(geom = "text", x = 0, y = 100, label = "y = 10.403 + 2.957x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 10.403, slope = 2.957)) +
annotate(geom = "text", x = 0, y = 40, label = "y = 10.403 + 2.957x") +
theme_minimal()
fit$coefficients
fit
fit$coefficients[1]
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 10.403, slope = 2.957)) +
annotate(geom = "text", x = 0, y = 40, label = "y = fit$coefficients[1] + fit$coefficients[2]*x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 10.403, slope = 2.957)) +
annotate(geom = "text", x = 0, y = 40, label = "y = fit$coefficients[1] + fit$coefficients[2]x) +
theme_minimal()
fit$coefficients[1]
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 10.403, slope = 2.957)) +
annotate(geom = "text", x = 0, y = 40, label = "y = fit$coefficients[1] + fit$coefficients[2]x) +
theme_minimal()
fit$coefficients[1]
fit$coefficients[1]*fit$coefficients[2]
Intercept <- fit$coefficients[1]
rm(Intercept)
coef_ln <- coefficients(fit)[["sch_year"]]
rm(coef_ln)
stargazer(fit, type = "text", no.space = TRUE)
fit
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 10.403, slope = 2.957)) +
annotate(geom = "text", x = 0, y = 40, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 0, y = 40, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 0, y = 20, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 10, y = 20, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 15, y = 10, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 10, y = 10, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 10, y = 12, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 10, y = 13, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 10, y = 6, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 10, y = 9, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 12, y = 9, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065)) +
annotate(geom = "text", x = 11, y = 9, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065), color="red") +
annotate(geom = "text", x = 11, y = 9, label = "y = 4.385 + 0.065x") +
theme_minimal()
fit2 <- lm(income ~ sch_year, df)
stargazer(fit2, type = "text", no.space = TRUE)
df %>% ggplot(aes(x = sch_year, y = income)) +
geom_point() +
geom_abline(aes(intercept = -56.893, slope =  23.151), color="red") +
annotate(geom = "text", x = 11, y = 9, label = "y = -56.893 + 23.151x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = income)) +
geom_point() +
geom_abline(aes(intercept = -56.893, slope =  23.151), color="red") +
annotate(geom = "text", x = 11, y = 1200, label = "y = -56.893 + 23.151x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = income)) +
geom_point() +
geom_abline(aes(intercept = -56.893, slope =  23.151), color="red") +
annotate(geom = "text", x = 11, y = 1100, label = "y = -56.893 + 23.151x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = income)) +
geom_point() +
geom_abline(aes(intercept = -56.893, slope =  23.151), color="red") +
annotate(geom = "text", x = 11, y = 1050, label = "y = -56.893 + 23.151x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065), color="red") +
annotate(geom = "text", x = 11, y = 9, label = "y = 4.385 + 0.065x") +
theme_minimal()
df %>% ggplot(aes(x = sch_year, y = ln_income)) +
geom_point() +
geom_abline(aes(intercept = 4.385, slope = 0.065), color="red") +
annotate(geom = "text", x = 11, y = 8, label = "y = 4.385 + 0.065x") +
theme_minimal()
